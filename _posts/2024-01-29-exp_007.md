---
layer: single
title: "Aiffel) Exploration - MLOps ì •ë¦¬"
categories: Exploration
tag: [MLOps]
---

ë‚´ìš© ì¶œì²˜ : [Aiffel](https://www.aiffel.io/)

## í•™ìŠµ ëª©í‘œ
- MLOps ì´ë¡ ì— ëŒ€í•œ ê¸°ì´ˆë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- KerasTunerë¡œ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- TFServingì´ë‚˜ TFLiteë¡œ ëª¨ë¸ì„ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 1. MLOpsì˜ ì •ì˜
- ê°œë… : ë¨¸ì‹ ëŸ¬ë‹(ML)ê³¼ Operations(Ops)ê°€ í•©ì³ì§„ ì²´ê³„

### 1) MLOps vs DevOpsì˜ ì£¼ìš” ì°¨ì´ì  : ["Hidden Technical Debt in Machine Learning Systems"](https://proceedings.neurips.cc/paper_files/paper/2015/file/86df7dcfd896fcaf2674f757a2463eba-Paper.pdf)
- `ê°œë°œ/ë°°í¬ : ì†ë„â–²  ë¹„ìš©â–¼` / `ìœ ì§€ : ë‚œì´ë„â–², ë¹„ìš©â–¼` (ìƒëŒ€ì ìœ¼ë¡œ)
- ê¸°ìˆ  ë¶€ì±„ ê°ì§€ í˜ë“¬(ì‹œìŠ¤í…œ ì°¨ì›ì—ì„œ ë°œìƒ) â†’ ìˆ¨ê²¨ì§„ ê¸°ìˆ  ë¶€ì±„

### 2) MLOps vs DevOpsì˜ ì°¨ì´ì˜ ì£¼ìš” ì›ì¸

- **ë¨¸ì‹ ëŸ¬ë‹ê³¼ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ë°©ì‹ì˜ ì°¨ì´(Complex Models Erode Boundaries)**
	- ì¶”ê°€ í•™ìŠµì„ ì§„í–‰ ì‹œ ëª¨ë“  ì„¤ì • ê°’ ë³€ê²½ â†’ ì—…ë¬´ ìº¡ìŠí™”, ëª¨ë“ˆí™”í•˜ê¸° í˜ë“¬<br/>

---

- **ë°ì´í„° ë””íœë”ì‹œ(Data Dependencies Cost More than Code Dependencies)**
	- ì»´íŒŒì¼ëŸ¬ë¡œ í•´ê²° ë¶ˆê°€ â†’ ì˜¤ë¥˜ ì›ì¸ ì¸ì§€ í˜ë“¬
	- í•˜ë‚˜ì˜ ë°ì´í„° ìˆ˜ì • â†’ ì „ì²´ ì‹œìŠ¤í…œì˜ ë³€ê²½(ì‹œìŠ¤í…œ ë¬¸ì œ ìœ ë°œ ê°€ëŠ¥)<br/>

---

- **í”¼ë“œë°± ìˆœí™˜ë£¨í”„(Feedback Loops)**
	- í”¼ë“œë°±ì„ ë°›ì•„ ìˆ˜ì •í• ë•Œ ë‹¤ë¥¸ ê³³ì—ë„ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê²ƒ<br/>

---

- **ë¨¸ì‹ ëŸ¬ë‹ì˜ ì•ˆí‹° íŒ¨í„´ë“¤(ML-System Anti-Patterns)**
	- ë‹¤ì–‘í•œ ì˜ì—­ â†’ ì ‘ì°© ì½”ë“œ ë‚¨ë°œ â†’ í˜¸í™˜ì„± ì´ìŠˆ<br/>

---

- **ì„¤ì • ë¶€ì±„(Configuration Debt)**
	- í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì„¤ì • ê°’ì— ëŒ€í•œ ê²€ì¦ì´ë‚˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì§€ ì•ŠëŠ” ê²½í–¥<br/>

---

- **í˜„ì‹¤ì—ì„œ ë°œìƒí•˜ëŠ” ë³€í™”ë“¤(Dealing with Changes in the External World)**
	- ì™¸ë¶€ í™˜ê²½ ë³€í™”ë¡œ ì¸í•´ ëª¨ë‹ˆí„°ë§ê³¼ í…ŒìŠ¤íŒ…ì„ ì§€ì†ì ìœ¼ë¡œ ì§„í–‰í•´ì•¼ í•¨


## 2. MLOpsì˜ êµ¬ì„±ìš”ì†Œ
### 1) MLOps êµ¬ì„±ìš”ì†Œ(ì¶œì²˜ : Hidden Technical Debt in Machine Learning Systems)
![content img](https://d3s0tskafalll9.cloudfront.net/media/images/mlops_2015_paper_Gdw5hED.max-800x600.png)

### 2) MLOps ê³¼ì •
- **ì„¤ì •(Configuration)**
	- í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì • ê°’, í”„ë ˆì„ì›Œí¬, ì„œë¹™ë°©ì‹ ë“± ì„¤ì • í•„ìš”

---

- **ë°ì´í„° ìˆ˜ì§‘ (Data Collection)** 
	- ì¢‹ì€ ëª¨ë¸ì„ ìœ„í•œ ì¢‹ì€ ë°ì´í„° ìˆ˜ì§‘

---

- **íŠ¹ì„± ì¶”ì¶œ(Feature Extraction)** (ğŸ“Œë°ì´í„° ì „ì²˜ë¦¬)
	- ìˆ˜ì§‘ëœ ë°ì´í„°ì— ëŒ€í•œ ì´í•´ë„ë¥¼ ë†’ì„ â†’ ì˜¬ë°”ë¥¸ ëª¨ë¸ ì„ íƒ

---

- **ë°ì´í„° ê²€ì¦ (Data Verification)** (ğŸ“Œëª¨ë¸ í•™ìŠµ ì „ ë°ì´í„° ê²€ì¦)
	- ë°ì´í„°ì˜ ì •í™•ì„±, ì‚¬ìš©ì„± ì¬ê²€ì¦ í•„ìš”

---

- **ë¶„ì„ ë„êµ¬ (Analysis Tools) í™œìš©** (ğŸ“Œê°œë°œ : ëª¨ë¸ í‰ê°€ìš©)
	- ëŒ€í‘œì ì¸ íˆ´ : TensorBoard, W&B, mlflow ë“±

---

- **í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ íˆ´(Process Management Tools)**  (ğŸ“Œê°œë°œ/ìœ ì§€ : í˜¸í™˜ì„± ê´€ë¦¬)
	- ëŒ€í‘œì ì¸ íˆ´ : airflow, TFX, Kubeflow ë“±
		- [ë§ˆì¼“ì»¬ë¦¬ì˜ Kubeflow ë„ì…ê¸°](https://helloworld.kurly.com/blog/second-mlops/)
		- [ì˜¤ëŠ˜ì˜ì§‘ì˜ Airflow ë„ì…ê¸°](https://www.bucketplace.com/post/2021-04-13-%EB%B2%84%ED%82%B7%ED%94%8C%EB%A0%88%EC%9D%B4%EC%8A%A4-airflow-%EB%8F%84%EC%9E%85%EA%B8%B0/)
		- [ìŠ¤ìºí„°ë©ì˜ TFX ë„ì…ê¸°](https://tech.scatterlab.co.kr/use-tfx-pipeline-with-customization/)

---

- **ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ (Machine Resource Management)**
	- ë¹„ìš© ë¬¸ì œë¡œ ë¦¬ì†ŒìŠ¤(GPU ë“±) ê´€ë¦¬ í•„ìš”
	- ëŒ€í‘œì ì¸ íˆ´ : ì¿ ë²„ë„¤í‹°ìŠ¤(ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ íˆ´), TerraForm(ì½”ë“œë¡œ ì¸í”„ë¼ ê´€ë¦¬)

---

- **ì¸í”„ë¼ ë°°í¬ (Serving Infrastructure)**  (ğŸ“Œë°°í¬ : ì„œë¹„ìŠ¤í™” í›„ ë°°í¬)
	- ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ Databaseì— ì €ì¥ vs API
	- ëŒ€í‘œì ì¸ íˆ´ : BentoML, Gradio ë“±

---

- **ëª¨ë‹ˆí„°ë§(Monitoring)**  (ğŸ“Œìœ ì§€ : ì¶”ê°€ í•™ìŠµ í•„ìš” íŒë‹¨)
	- ëŒ€í‘œì ì¸ íˆ´ : VertexAI ë“±

## 3.  MLOpsíˆ´ : TFX (TensorFlow Extended)
- TFXì˜ ì¥ì  : **ë‹¨ì¼ ì˜¤í”ˆì†ŒìŠ¤ í”Œë«í¼ë¡œ End-to-Endë¡œ êµ¬í˜„ê°€ëŠ¥**
- ëŒ€í‘œì ì¸ TFX (mlflow, airflow, Kubeflow)
	![content img](https://d3s0tskafalll9.cloudfront.net/media/images/mlflow_airflow_tfx.max-800x600.png)

| êµ¬ë¶„ | ì¥ì  | ë‹¨ì  |
| ---- | ---- | ---- |
| MLflow | - ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©ê°€ëŠ¥<br>- Jupyter Notebook ì§€ì› | - í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ë¯¸ì§€ì› |
| Apach<br>Airflow | - ë²”ìš©ì ì¸ task orchestration ì§€ì› | - task orchestrationë§Œì„ ì§€ì› |
| Kubeflow | - workflow orchestration ì§€ì›<br>- Model management ì§€ì›<br>- notebook workspace ì§€ì› | - Kubernetes êµ¬ë™ í•„ìš” â†’ ì‚¬ìš© ë¦¬ì†ŒìŠ¤ â–² |

<br/>

- TFX ì˜ˆì‹œ

	![content img](https://d3s0tskafalll9.cloudfront.net/media/images/tfx.max-800x600.png)
	- `ì»´í¬ë„ŒíŠ¸`ë¡œ ê´€ë¦¬ â†’ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
		- CSV / BigQuery / Kubeflow pipeline í™œìš© ê°€ëŠ¥
		- Vertex AIë¥¼ í™œìš© ê°€ëŠ¥
		- CPU/GPUê°™ì€ í™˜ê²½ì— ìƒê´€ì—†ì´ ì‚¬ìš© ê°€ëŠ¥
	- [ìŠ¤ìºí„°ë© - TFX ë¨¸ì‹ ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸ ì‚¬ìš©í•˜ê¸°](https://tech.scatterlab.co.kr/use-tfx-pipeline-with-customization/)
	- [ë‹¹ê·¼ë§ˆì¼“ - TFXì™€ í•¨ê»˜ ë¨¸ì‹ ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸ ê°œë°œí•˜ê¸°](https://medium.com/daangn/tfx%EC%99%80-%ED%95%A8%EA%BB%98-%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8-%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0-4578f030a9c1)

## 4. TFXì˜ í‘œì¤€ ì»´í¬ë„ŒíŠ¸ ì¢…ë¥˜
### 1) ë°ì´í„° ì…ë ¥ ì»´í¬ë„ŒíŠ¸
- **ExampleGen** : ë°ì´í„°ë¥¼ TFX Pipelineìœ¼ë¡œ ë„£ëŠ” ì»´í¬ë„ŒíŠ¸
	- Validation, Transformì— ì‚¬ìš©ë  ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ë°ì´í„° ì œê³µ  (ğŸ“ŒData Split)
	- ì…ë ¥ : CSV, TFRecord, BigQuery
	- ì¶œë ¥ : tf.Example Record, tf.SequenceExample records, [.protoíŒŒì¼](https://bcho.tistory.com/1182)
		![content img](https://d3s0tskafalll9.cloudfront.net/media/original_images/ExampleGen.png)

<br/>

- **StatisticsGen** : ì…ë ¥ ë°ì´í„° í†µê³„ë¥¼ ìƒì„±(ì‹œê°í™”)
	![content img](https://d3s0tskafalll9.cloudfront.net/media/images/StatisticsGen.max-800x600.png)

<br/>

- **SchemaGen** : ìŠ¤í‚¤ë§ˆê°€ ì—†ì„ ê²½ìš° ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•˜ëŠ” ì»´í¬ë„ŒíŠ¸
	- ìŠ¤í‚¤ë§ˆ : ë°ì´í„°ë² ì´ìŠ¤ì˜ ê°œì²´/ì†ì„±/ê´€ê³„ ë“±ì„ ê³ ë ¤íŒ ë…¼ë¦¬ì ì¸ ì €ì¥ êµ¬ì¡°

<br/>

- **ExampleValidator** : í›ˆë ¨ ë° ì œê³µ ë°ì´í„°ì— ìˆëŠ” ë¬¸ì œì ì„ ì‹ë³„

### 2) Transform ì»´í¬ë„ŒíŠ¸(ì „ì²˜ë¦¬)
- **TensorFlow Transform** : ì „ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì‹œê°í™” / ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì— ë°ì´í„° ì´ê´€
	- ìì—°ì–´ ì²˜ë¦¬ : ngram,bag of words, TFIDF ë“±ì— ì ìš© ê°€ëŠ¥
	- ì»´í“¨í„° ë¹„ì „ : ì´ë¯¸ì§€ ë””ì½”ë”©, í”½ì…€ ì¡°ì • ê°€ëŠ¥
	- Apache Beamì— ì´ì‹í•´ì„œ ì‚¬ìš© ê°€ëŠ¥
		- Apache Beam : ë°°ì¹˜ ë° ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ ë¼ì¸ì„ ì •ì˜/ì‹¤í–‰í•˜ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ í†µí•© í”„ë¡œê·¸ë˜ë° ëª¨ë¸

### 3) Trainer ì»´í¬ë„ŒíŠ¸(ëª¨ë¸ í•™ìŠµ)
- íŒŒì´í”„ë¼ì¸ì˜ í•™ìŠµ ë‹¨ê³„ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸
	- ëª¨ë¸ ì‘ì„± â†’ í•™ìŠµ ì½”ë“œ ìƒì„± â†’ í•´ë‹¹ ì½”ë“œë¥¼ TFXì— í†µí•©
	- Keras ëª¨ë¸ í•„ìš”
	- í…ì„œë³´ë“œ ì—°ê²°, ì„±ëŠ¥ ë³‘ëª© í˜„ìƒì´ íŒŒì•… ê°€ëŠ¥
	- savedModelì„ ì‚¬ìš©í•´, ëª¨ë¸ ì €ì¥ ê°€ëŠ¥
		- saved_model.pb : ê·¸ë˜í”„ êµ¬ì¡° í¬í•¨(pbëŠ” í”„ë¡œí† ì½œ ë²„í¼ë¥¼ ì˜ë¯¸)
		- variables : ë³€ìˆ˜ê°’ì´ ìˆëŠ” ì´ì§„ íŒŒì¼, ê·¸ë˜í”„ì— í•´ë‹¹í•˜ëŠ” ì²´í¬í¬ì¸íŠ¸ í¬í•¨
		- assets : ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¬ ë•Œ ì¶”ê°€ì ì¸ íŒŒì¼ì´ í•„ìš”í•œ ê²½ìš°(ì´ í´ë”ì— íŒŒì¼ì´ ìƒì„±)

### 4) Tuner ì»´í¬ë„ŒíŠ¸(ëª¨ë¸ íŠœë‹)
- KerasTuner / Google Cloud Platformì œê³µ Tuner

| êµ¬ë¶„ | íŠ¹ì§• |
| ---- | ---- |
| KerasTuner | - ì½”ë“œë¡œ ì œì–´ ê°€ëŠ¥(ì‰¬ìš´ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹)<br>- ë³‘ë ¬ íŠœë‹ ì§€ì›(íš¨ìœ¨ì„±)<br>- Grid Search/Random Search ì§€ì›<br>- Bayesian Optimization ì§€ì› |
| Google Cloud Platformì œê³µ Tuner | - âœ¨ KerasTuner ì‚¬ìš© ì•Œê³ ë¦¬ì¦˜ ì „ë¶€ ì‚¬ìš© ê°€ëŠ¥<br>- âœ¨ í´ë¼ìš°ë“œ ë¹„ìš© ë°œìƒí•¨ |

### 5) Evaluator,Â Pusher ì»´í¬ë„ŒíŠ¸
- Evaluator ì»´í¬ë„ŒíŠ¸ :ê²€ì¦ ë°ì´í„°ì…‹ì— ëŒ€í•œ ëª¨ë¸ ì˜ˆì¸¡ í‰ê°€(TensorFlow Model Analysis í™œìš©)
	- í…ì„œë³´ë“œëŠ” ë¯¸ë‹ˆë°°ì¹˜ìƒ ì¶”ë¡ ëœ ëŒ€ëµì ì¸ ì§€í‘œë§Œ ì œê³µ
	- TensorFlow Model Analysisì€ ì „ì²´ í‰ê°€ ë°ì´í„°ì…‹ì„ í†µí•´ ì§€í‘œ ê³„ì‚°

- Pusher ì»´í¬ë„ŒíŠ¸ : ëª¨ë¸ì„ ì„œë¹™ íŒŒì¼ ê²½ë¡œë¡œ ì œê³µ

### 6) TensorFlow Serving ì»´í¬ë„ŒíŠ¸
- ê·¸ë˜í”„ì—ì„œ ì˜ˆì¸¡ / ëª¨ë¸ ë° ë²„ì „ ê´€ë¦¬
- ë‹¤ì–‘í•œ ì†ŒìŠ¤ì—ì„œ ëª¨ë¸ ë¡œë“œ ê°€ëŠ¥
- ì €ì¥ëœ ëª¨ë¸ì— ëŒ€í•œ REST APIì¶”ë¡  ì„œë²„ë¥¼ ë§Œë“¤ì–´ ê²°ê³¼ ê°’ ë°˜í™˜

## 5. Data Centric AI
- ì •ì˜ : ë°ì´í„°ì˜ ì§ˆê³¼ êµ¬ì¡°ì— ì¤‘ì ì„ ë‘ëŠ” ì¸ê³µì§€ëŠ¥ ê°œë°œ ë°©ë²•ë¡ 
- ë°©ë²• : ëª¨ë¸ì€ ê³ ì •í•´ ë‘”ì±„ë¡œ ë°ì´í„° ìì²´ ê²°í•¨ì„ ìµœì†Œí™”ì‹œì¼œ ì„±ëŠ¥ í–¥ìƒ
	- Label ê²€ìˆ˜í•˜ê¸° : ë°ì´í„°ì…‹ì˜ ì •í™•ë„ì™€ ì‹ ë¢°ë„ë¥¼ ë³´ì¥
	- Confident Learning :ë…¸ì´ì¦ˆê°€ ìˆëŠ” ë°ì´í„°ë¥¼ ì—†ì• ê³  ë…¸ì´ì¦ˆë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•´ ê³„ì‚°í•˜ê³  ì˜ˆì œì— ëŒ€í•œ ë­í‚¹ì„ ë§¤ê¸°ëŠ” í•™ìŠµë°©ì‹(cleanlab ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©)
		![content img](https://d3s0tskafalll9.cloudfront.net/media/images/confident_learning_digram.max-800x600.jpg)
	- ë°ì´í„° ì „ì²˜ë¦¬ : ë¶„í¬ í™•ì¸ / ì´ìƒì¹˜ ì²˜ë¦¬ / ì„œë¹„ìŠ¤ì—ì„œ ì“°ì¸ ë°ì´í„°ê°€ ë‹¤ì‹œ í›ˆë ¨ ë°ì´í„°ë¡œ ë“¤ì–´ê°€ëŠ” ê³¼ì • ì„¤ê³„
	- ê¸°ì¤€ì— ë§ê²Œ ë°ì´í„°ì…‹ êµ¬ì¶•í•˜ê¸°(ë¼ë²¨ë§ ê¸°ì¤€ì  ë§Œë“¤ê¸°, ìë™í™”í•˜ê¸° ë“±)
		- Multi Annotator ê¸°ë²•
			![content img](https://d3s0tskafalll9.cloudfront.net/media/images/multiannotator_pug.max-800x600.png)
	- Data Centricì— ë§ëŠ” í‰ê°€ ì§€í‘œ ë§Œë“¤ê¸° : í™•ë¥ ë¡œ í‰ê°€(ë§ë‹¤/ì•„ë‹ˆë‹¤ ë³´ë‹¤ êµ¬ì²´ì ì¸ í‰ê°€)

## 6. Keras Tunner ì½”ë“œ êµ¬í˜„

- Tunner  ì„¤ì¹˜
	```python
	!pip install keras-tuner
	```

- ë°ì´í„° ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°
	```python
	import tensorflow as tf
	import keras
	import keras_tuner as kt
	from sklearn.model_selection import train_test_split
	import os

	(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()

	# CNN ì‚¬ìš©ì— ë”°ë¥¸ ì°¨ì› ì¶”ê°€
	X_train = x_train.reshape(-1,28, 28, 1)
	X_test = x_test.reshape(-1,28,28,1)

	# labelì„ ìˆ«ìë¡œ ë³€ê²½
	y_train = tf.keras.utils.to_categorical(y_train)
	y_test = tf.keras.utils.to_categorical(y_test)

	# ë°ì´í„°ì…‹ ë¶„í• 
	X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size = 0.2)
	```


- ëª¨ë¸ í•™ìŠµ ë©”ì„œë“œ
	```python
	class DeepTuner(kt.Tuner):
		def run_trial(self, trial, X, y, validation_data, **fit_kwargs):
			model = self.hypermodel.build(trial.hyperparameters)
			model.fit(X, y, batch_size=trial.hyperparameters.Choice('batch_size', [16, 32]), **fit_kwargs)

			X_val, y_val = validation_data
			eval_scores = model.evaluate(X_val, y_val)
			return {name: value for name, value in zip(model.metrics_names, eval_scores)}
	```

	```python
	my_keras_tuner = DeepTuner(oracle=kt.oracles.BayesianOptimizationOracle(objective=kt.Objective('accuracy', 'max'), max_trials=10, seed=42), hypermodel=build_model, overwrite=True, project_name='my_keras_tuner')
	
	# í•´ë‹¹ ëª¨ë¸ í•™ìŠµì‹œê°„ì€ ì•½ 10ë¶„ì •ë„ ê±¸ë¦½ë‹ˆë‹¤!
	my_keras_tuner.search(X_train, y_train, validation_data=(X_val, y_val), epochs=3)
	```

- ëª¨ë¸ í™•ì¸
	```python
	best_hps = my_keras_tuner.get_best_hyperparameters(num_trials=10)[0]
	model = build_model(best_hps)
	model.summary()
	```

- ëª¨ë¸ í•™ìŠµ
	```python
	model.fit(X_train, y_train, batch_size=32, epochs = 5)
	```

- ëª¨ë¸ í‰ê°€
	```python
	model.evaluate(X_test, y_test)
	```

- ëª¨ë¸ ì €ì¥
	```python
	save_path = #[ì›í•˜ëŠ” ê²½ë¡œ]
	fname = os.path.join(save_path, 'model')
	model.save(fname)
	```

## 7. TFServing & TFLite : ëª¨ë¸ ë°°í¬
### 1)ìš°ë¶„íˆ¬ í„°ë¯¸ë„
- tensorflow-model-serverì„¤ì¹˜í•´ ë°°í¬ìš© í…ì„œí”Œë¡œìš° ì„œë²„ êµ¬ì¶•
	```bash
	$ echo "deb [arch=amd64] http://storage.googleapis.com/tensorflow-serving-apt stable tensorflow-model-server tensorflow-model-server-universal" | sudo tee /etc/apt/sources.list.d/tensorflow-serving.list && \
	curl https://storage.googleapis.com/tensorflow-serving-apt/tensorflow-serving.release.pub.gpg | sudo apt-key add -
	$ sudo apt update
	$ sudo apt install tensorflow-model-server
	```

- ëª¨ë¸ ë°°í¬
	```bash
	$ tensorflow_model_server --port=8500 \
							--rest_api_port=8501 \
							--model_name=my_model \
							--model_base_path= [ì‹¤ì œ ëª¨ë¸ ê²½ë¡œ]
	```

### 2) Docker
- WSL2ì‰˜ì— ì‹¤í–‰(ë§¥ë¶ì€ í„°ë¯¸ë„ì—ì„œë„ ê°€ëŠ¥)
	```bash
	docker pull tensorflow/serving
	```

	```bash
	docker run -p 8500:8500 \
				-p 8501:8501 \
				--mount type=bind, source=[ì‹¤ì œ í´ë”], target=[ì‹¤ì œ ëª¨ë¸ ê²½ë¡œ]
				-e MODEL_NAME=my_model \
				-e MODEL_BASE_PATH=[ì‹¤ì œ ëª¨ë¸ ê²½ë¡œ] \
				-t tensorflow/serving
	```

> ì²« ë²ˆì§¸ ì¤„ : ê¸°ë³¸ í¬íŠ¸ ì§€ì •<br/>
> ë‘ ë²ˆì§¸ ì¤„ : API í¬íŠ¸ ì§€ì •<br/>
> ì„¸ ë²ˆì§¸ ì¤„ : ëª¨ë¸ ë””ë ‰í† ë¦¬ ë§ˆìš´íŠ¸<br/>
> ë„¤ ë²ˆì§¸ ì¤„ : ëª¨ë¸ ì´ë¦„ ì§€ì •<br/>
> ë‹¤ì„¯ ë²ˆì§¸ ì¤„ : ëª¨ë¸ ê¸°ë³¸ ê²½ë¡œ ì§€ì •<br/>
> ë§ˆì§€ë§‰ ì¤„ : tensorflow/servingì„ ì‚¬ìš©í•œë‹¤ëŠ” ëœ»

![content img](https://d3s0tskafalll9.cloudfront.net/media/images/tfserving_result.max-800x600.png)
{: .align-center}

ê²°ê³¼í™”ë©´
{: style="text-align: center;"}

## âœ¨ TFLiteë¡œ ê²½ëŸ‰í™” ëª¨ë¸ ë§Œë“¤ê¸°
- ì–‘ìí™”ë¼ëŠ” ê¸°ë²•ì„ í™œìš©í•´ ëª¨ë¸ì˜ í¬ê¸°ë¥¼ ì¤„ì´ì§€ë§Œ ì„±ëŠ¥ì´ í¬ê²Œ ì €í•˜ë˜ì§€ ì•ŠìŒ

- ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°
	```python
	load_path = # [ì‹¤ì œ ëª¨ë¸ ê²½ë¡œ]
	best_model = tf.keras.models.load_model(load_path)
	```

- tfileíŒŒì¼ë¡œ ë³€í™˜
	```python
	converter = tf.lite.TFLiteConverter.from_keras_model(model)
	tflite_model = converter.convert()
	```

- ë³´ê´€
	```python
	with open('model.tflite', 'wb') as f:
	Â  f.write(tflite_model)
	```

- ì„œëª… í™•ì¸
	```python
	interpreter = tf.lite.Interpreter(model_content=tflite_model)

	signatures = interpreter.get_signature_list()
	print(signatures)
	```
	
	![content img](https://d3s0tskafalll9.cloudfront.net/media/images/signatures.max-800x600.png)
	{: .align-center}

	ê²°ê³¼í™”ë©´
	{: style="text-align: center;"}

	```python
	classify_lite = interpreter.get_signature_runner('serving_default')
	classify_lite
	```
	
	![content img](https://d3s0tskafalll9.cloudfront.net/media/images/classifiy.max-800x600.png)
	{: .align-center}

	ê²°ê³¼í™”ë©´
	{: style="text-align: center;"}

## âœ¨ ê´€ë ¨ í”„ë¡œì íŠ¸ ë§í¬
- [github_file_link](https://github.com/NeatyNut/AIFFEL_Online_Quest/blob/main/Exploration/Ex07/Exploration_%EB%AA%A8%EB%8D%B8%20%ED%95%98%EC%9D%B4%ED%8D%BC%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0%20%ED%8A%9C%EB%8B%9D.ipynb)